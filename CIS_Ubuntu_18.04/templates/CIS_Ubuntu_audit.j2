CIS_Ubuntu18.04 check against running server (Only Scored Checks)
Scored report at {{ ansible_date_time.date }} on {{ ansible_date_time.time }}

Server Scores
#------------------------------------------------------------------------------
{% for host in ansible_play_hosts_all %}
{{ hostvars[host].ansible_hostname }} - IP:{{ host }}
 Section 1 Checks:
{% if 'cramfs' in hostvars[host].filesystems_check.stdout %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.1.1 - Ensure Cramf is disabled
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.1.1
{% endif %}
{% if 'freevxfs' in hostvars[host].filesystems_check.stdout %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.1.2 - Ensure freevxfs is disabled
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.1.2
{% endif %}
{% if 'jffs2' in hostvars[host].filesystems_check.stdout %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.1.3 - Ensure jffs2 is disabled
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.1.3
{% endif %}
{% if 'hfs' in hostvars[host].filesystems_check.stdout %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.1.4 - Ensure hfs is disabled
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.1.4
{% endif %}
{% if 'hfsplus' in hostvars[host].filesystems_check.stdout %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.1.5 - Ensure hfsplus is disabled
{% else %}
  {{ hostvars[host].ansible_hostnamet }} passed check 1.1.1.5
{% endif %}
{% if 'udf' in hostvars[host].filesystems_check.stdout %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.1.6 - Ensure udf is disabled
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.1.6
{% endif %}
{% if hostvars[host].check_tmp.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.2
{% if 'nodev' in hostvars[host].check_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.3
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.3 - Ensure that /tmp has nodev option set
{% endif %}
{% if 'nosuid' in hostvars[host].check_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.4
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.4 - Ensure that /tmp has nosuid option set
{% endif %}
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.2 - Ensure that /tmp is on it's own partition
{% if 'nodev' in hostvars[host].check_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.3
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.3 - Ensure that /tmp has nodev option set
{% endif %}
{% if 'nosuid' in hostvars[host].check_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.4
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.4 - Ensure that /tmp has nosuid option set
{% endif %}
{% endif %}
{% if hostvars[host].check_var.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.5
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.5 - Ensure that /var is on it's own partition
{% endif %}
{% if hostvars[host].check_var_tmp.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.6
{% if 'nodev' in hostvars[host].check_var_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.7
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.7 - Ensure that /var/tmp has nodev option set
{% endif %}
{% if 'nosuid' in hostvars[host].check_var_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.8
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.8 - Ensure that /var/tmp has nosuid option set
{% endif %}
{% if 'noexec' in hostvars[host].check_var_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.9
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.9 - Ensure that /var/tmp has noexec option set
{% endif %}
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.6 - Ensure that /var/tmp is on it's own partition
{% if 'nodev' in hostvars[host].check_var_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.7
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.7 - Ensure that /var/tmp has nodev option set
{% endif %}
{% if 'nosuid' in hostvars[host].check_var_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.8
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.8 - Ensure that /var/tmp has nosuid option set
{% endif %}
{% if 'noexec' in hostvars[host].check_var_tmp.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.9
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.9 - Ensure that /var/tmp has noexec option set
{% endif %}
{% endif %}
{% if hostvars[host].check_var_log.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.10
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.10 - Ensure that /var/log is on it's own partitio
{% endif %}
{% if hostvars[host].check_var_log_audit.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.11
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.11 - Ensure that /var/log/audit is on it's own partitio
{% endif %}
{% if hostvars[host].check_home.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.12
{% if 'nodev' in hostvars[host].check_home.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.13
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.13 - Ensure that /home has nodev option set
{% endif %}
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.12 - Ensure that /home is on it's own partition
{% if 'nodev' in hostvars[host].check_home.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.13
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.13 - Ensure that /home has nodev option set
{% endif %}
{% endif %}
{% if 'nodev' in hostvars[host].check_dev_shm.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.14
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.14 - Ensure that /dev/shm has nodev option set
{% endif %}
{% if 'nosuid' in hostvars[host].check_dev_shm.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.15
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.15 - Ensure that /dev/shm has nosuid option set
{% endif %}
{% if 'noexec' in hostvars[host].check_dev_shm.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.16
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.16 - Ensure that /dev/shm has noexec option set
{% endif %}
{% if hostvars[host].check_1_1_20.stdout_lines | length %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.20 - Ensure sticky bit is set on all world-writable directories
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.20
{% endif %}
{% if hostvars[host].check_1_1_21.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} failed check 1.1.21 - Disable Automounting
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.1.21
{% endif %}
{% if hostvars[host].check_1_3_1.rc == 1 %}
  {{ hostvars[host].ansible_hostname }} failed check 1.3.1 - Aide is not installed
  {{ hostvars[host].ansible_hostname }} failed check 1.3.2 - Ensure filesystem integrity is regularly checked
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.3.1
{% if hostvars[host].check_1_3_2.rc != 0 %}
  {{ hostvars[host].ansible_hostname }} failed check 1.3.2 - Ensure Filesystem integrity is regularly checked (with Aide)
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.3.2
{% endif %}
{% endif %}
{% if (hostvars[host].check_1_4_1.stat.mode | regex_search('00$')) is none %}
  {{ hostvars[host].ansible_hostname }} failed check 1.4.1 - Ensure permissions on bootloader config are configured  
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.4.1
{% endif %}
{% if hostvars[host].check_1_4_2.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.4.2
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.4.2 - Ensure bootloader password is set  
{% endif %}
{% if hostvars[host].check_1_4_3.stdout_lines | length %}
  {{ hostvars[host].ansible_hostname }} failed check 1.4.3 - Ensure authentication required for single user mode
{% else %}
  {{ hostvars[host].ansible_hostname }} passed check 1.4.3
{% endif %}
{% if '0' in hostvars[host].check_1_5_1.stdout %}
  {{ hostvars[host].ansible_hostname }} passed check 1.5.1
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.5.1- Ensure core dumps are restricted
{% endif %}
{% if hostvars[host].check_1_5_3.rc == 0 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.5.3
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.5.3 - Ensure ASLR is enabled
{% endif %}
{% if hostvars[host].check_1_5_4.rc == 1 %}
  {{ hostvars[host].ansible_hostname }} passed check 1.5.4
{% else %}
  {{ hostvars[host].ansible_hostname }} failed check 1.5.4 - Ensure prelink is disabled
{% endif %}

{% endfor %}